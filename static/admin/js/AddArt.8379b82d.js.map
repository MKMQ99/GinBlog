{"version":3,"file":"js/AddArt.8379b82d.js","mappings":"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","sources":["webpack://admin/./src/components/article/AddArt.vue","webpack://admin/src/components/article/AddArt.vue","webpack://admin/./src/components/article/AddArt.vue?e9ac","webpack://admin/./src/components/article/AddArt.vue?6afc"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('a-card',[_c('h3',[_vm._v(_vm._s(_vm.id ? '编辑文章' : '新增文章'))]),_c('a-form-model',{ref:\"artInfoRef\",attrs:{\"model\":_vm.artInfo,\"rules\":_vm.artInfoRules,\"hideRequiredMark\":true}},[_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"span\":16}},[_c('a-form-model-item',{attrs:{\"label\":\"文章标题\",\"prop\":\"title\"}},[_c('a-input',{staticStyle:{\"width\":\"300px\"},model:{value:(_vm.artInfo.title),callback:function ($$v) {_vm.$set(_vm.artInfo, \"title\", $$v)},expression:\"artInfo.title\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"文章描述\",\"prop\":\"desc\"}},[_c('a-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.artInfo.desc),callback:function ($$v) {_vm.$set(_vm.artInfo, \"desc\", $$v)},expression:\"artInfo.desc\"}})],1)],1),_c('a-col',{attrs:{\"span\":8}},[_c('a-form-model-item',{attrs:{\"label\":\"文章分类\",\"prop\":\"cid\"}},[_c('a-select',{staticStyle:{\"width\":\"200px\"},attrs:{\"placeholder\":\"请选择分类\"},on:{\"change\":_vm.cateChange},model:{value:(_vm.artInfo.cid),callback:function ($$v) {_vm.$set(_vm.artInfo, \"cid\", $$v)},expression:\"artInfo.cid\"}},_vm._l((_vm.Catelist),function(item){return _c('a-select-option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])}),1)],1),_c('a-form-model-item',{attrs:{\"label\":\"文章缩略图\",\"prop\":\"img\"}},[_c('a-upload',{attrs:{\"listType\":\"picture\",\"name\":\"file\",\"action\":_vm.upUrl,\"headers\":_vm.headers},on:{\"change\":_vm.upChange}},[_c('a-button',[_c('a-icon',{attrs:{\"type\":\"upload\"}}),_vm._v(\"点击上传 \")],1),(_vm.id)?[_c('img',{staticStyle:{\"width\":\"120px\",\"height\":\"100px\",\"margin-left\":\"15px\"},attrs:{\"src\":_vm.artInfo.img}})]:_vm._e()],2)],1)],1)],1),_c('a-form-model-item',{attrs:{\"label\":\"文章内容\",\"prop\":\"content\"}},[_c('mavon-editor',{model:{value:(_vm.artInfo.content),callback:function ($$v) {_vm.$set(_vm.artInfo, \"content\", $$v)},expression:\"artInfo.content\"}})],1),_c('a-form-model-item',[_c('a-button',{staticStyle:{\"margin-right\":\"15px\"},attrs:{\"type\":\"danger\"},on:{\"click\":function($event){return _vm.artOk(_vm.artInfo.id)}}},[_vm._v(\" \"+_vm._s(_vm.artInfo.id ? '更新' : '提交')+\" \")]),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addCancel}},[_vm._v(\"取消\")])],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <a-card>\n      <h3>{{ id ? '编辑文章' : '新增文章' }}</h3>\n\n      <a-form-model :model=\"artInfo\" ref=\"artInfoRef\" :rules=\"artInfoRules\"\n        :hideRequiredMark=\"true\">\n        <a-row :gutter=\"24\">\n          <a-col :span=\"16\">\n            <a-form-model-item label=\"文章标题\" prop=\"title\">\n              <a-input style=\"width: 300px\" v-model=\"artInfo.title\"></a-input>\n            </a-form-model-item>\n            <a-form-model-item label=\"文章描述\" prop=\"desc\">\n              <a-input type=\"textarea\" v-model=\"artInfo.desc\"></a-input>\n            </a-form-model-item>\n          </a-col>\n          <a-col :span=\"8\">\n            <a-form-model-item label=\"文章分类\" prop=\"cid\">\n              <a-select style=\"width: 200px\" v-model=\"artInfo.cid\" placeholder=\"请选择分类\"\n                @change=\"cateChange\">\n                <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">\n                  {{\n                      item.name\n                  }}\n                </a-select-option>\n              </a-select>\n            </a-form-model-item>\n\n            <a-form-model-item label=\"文章缩略图\" prop=\"img\">\n              <a-upload listType=\"picture\" name=\"file\" :action=\"upUrl\" :headers=\"headers\"\n                @change=\"upChange\">\n                <a-button>\n                  <a-icon type=\"upload\" />点击上传\n                </a-button>\n\n                <template v-if=\"id\">\n                  <img :src=\"artInfo.img\" style=\"width: 120px; height: 100px; margin-left: 15px\" />\n                </template>\n              </a-upload>\n            </a-form-model-item>\n          </a-col>\n        </a-row>\n        <a-form-model-item label=\"文章内容\" prop=\"content\">\n          <mavon-editor v-model=\"artInfo.content\"/>\n        </a-form-model-item>\n\n        <a-form-model-item>\n          <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"artOk(artInfo.id)\">\n            {{\n                artInfo.id ? '更新' : '提交'\n            }}\n          </a-button>\n          <a-button type=\"primary\" @click=\"addCancel\">取消</a-button>\n        </a-form-model-item>\n      </a-form-model>\n    </a-card>\n  </div>\n</template>\n\n<script>\nimport { Url } from '../../plugin/http'\nexport default {\n  props: ['id'],\n  data () {\n    return {\n      artInfo: {\n        id: 0,\n        title: '',\n        cid: undefined,\n        desc: '',\n        content: '',\n        img: ''\n      },\n      Catelist: [],\n      upUrl: Url + 'upload',\n      headers: {},\n      fileList: [],\n      artInfoRules: {\n        title: [{ required: true, message: '请输入文章标题', trigger: 'change' }],\n        cid: [{ required: true, message: '请选择文章分类', trigger: 'change' }],\n        desc: [\n          { required: true, message: '请输入文章描述', trigger: 'change' },\n          { max: 120, message: '描述最多可写120个字符', trigger: 'change' }\n        ],\n        // img: [{ required: true, message: '请选择文章缩略图', trigger: 'change' }],\n        content: [{ required: true, message: '请输入文章内容', trigger: 'change' }]\n      }\n    }\n  },\n  mounted () {\n    this.getCateList()\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n    if (this.id) {\n      this.getArtInfo(this.id)\n    }\n  },\n  methods: {\n    // 查询文章信息\n    async getArtInfo (id) {\n      const { data: res } = await this.$http.get(`admin/article/info/${id}`)\n      if (res.status !== 200) {\n        // if (res.status === 1004 || 1005 || 1006 || 1007) {\n        //   window.sessionStorage.clear()\n        //   this.$message.error(res.message)\n        //   this.$router.push('/login')\n        //   return\n        // }\n        this.$message.error(res.message)\n        return\n      }\n      this.artInfo = res.data\n      this.artInfo.id = res.data.ID\n    },\n    // 获取分类列表\n    async getCateList () {\n      const { data: res } = await this.$http.get('admin/category')\n      if (res.status !== 200) return this.$message.error(res.message)\n      this.Catelist = res.data\n    },\n    // 选择分类\n    cateChange (value) {\n      this.artInfo.cid = value\n    },\n    // 上传图片\n    upChange (info) {\n      if (info.file.status === 'done') {\n        this.$message.success('图片上传成功')\n        this.artInfo.img = info.file.response.url\n      } else if (info.file.status === 'error') {\n        this.$message.error('图片上传失败')\n      }\n    },\n    // 提交&&更新文章\n    artOk (id) {\n      this.$refs.artInfoRef.validate(async (valid) => {\n        if (!valid) return this.$message.error('参数验证未通过，请按要求录入文章内容')\n        if (id === 0) {\n          const { data: res } = await this.$http.post('article/add', this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n          this.$router.push('/artlist')\n          this.$message.success('添加文章成功')\n        } else {\n          const { data: res } = await this.$http.put(`article/${id}`, this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n\n          this.$router.push('/artlist')\n          this.$message.success('更新文章成功')\n        }\n      })\n    },\n\n    addCancel () {\n      this.$refs.artInfoRef.resetFields()\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AddArt.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AddArt.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AddArt.vue?vue&type=template&id=6b6f204a&\"\nimport script from \"./AddArt.vue?vue&type=script&lang=js&\"\nexport * from \"./AddArt.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_v","_s","id","ref","attrs","artInfo","artInfoRules","staticStyle","model","value","title","callback","$$v","$set","expression","desc","on","cateChange","cid","_l","Catelist","item","key","name","upUrl","headers","upChange","img","_e","content","$event","artOk","addCancel","staticRenderFns","props","data","fileList","required","message","trigger","max","mounted","Authorization","methods","component"],"sourceRoot":""}